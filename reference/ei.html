<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="ei is the main command in the package EI.  It gives
observation-level estimates (and various related statistics) of
\(\beta_i^b\) and \(\beta_i^w\) given variables \(T_i\) and \(X_i\)
(\(i=1,...,n\)) in this accounting identity: \(T_i=\beta_i^b*X_i +
\beta_i^w*(1-X_i)\).  Results are stored in an ei object, that can be
read with summary() or eiread() and graphed in plot()."><title>Ecological Inference Estimation — ei • ei</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ecological Inference Estimation — ei"><meta property="og:description" content="ei is the main command in the package EI.  It gives
observation-level estimates (and various related statistics) of
\(\beta_i^b\) and \(\beta_i^w\) given variables \(T_i\) and \(X_i\)
(\(i=1,...,n\)) in this accounting identity: \(T_i=\beta_i^b*X_i +
\beta_i^w*(1-X_i)\).  Results are stored in an ei object, that can be
read with summary() or eiread() and graphed in plot()."><meta property="og:image" content="https://iqss-research.github.io/ei/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ei</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/ei.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ecological Inference Estimation</h1>
      
      <div class="d-none name"><code>ei.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ei</code> is the main command in the package <code>EI</code>.  It gives
observation-level estimates (and various related statistics) of
\(\beta_i^b\) and \(\beta_i^w\) given variables \(T_i\) and \(X_i\)
(\(i=1,...,n\)) in this accounting identity: \(T_i=\beta_i^b*X_i +
\beta_i^w*(1-X_i)\).  Results are stored in an <code>ei</code> object, that can be
read with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or <code><a href="eiread.html">eiread()</a></code> and graphed in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ei</span><span class="op">(</span>
  <span class="va">formula</span>,
  total <span class="op">=</span> <span class="cn">NULL</span>,
  Zb <span class="op">=</span> <span class="fl">1</span>,
  Zw <span class="op">=</span> <span class="fl">1</span>,
  id <span class="op">=</span> <span class="cn">NA</span>,
  data <span class="op">=</span> <span class="cn">NA</span>,
  erho <span class="op">=</span> <span class="fl">0.5</span>,
  esigma <span class="op">=</span> <span class="fl">0.5</span>,
  ebeta <span class="op">=</span> <span class="fl">0.5</span>,
  ealphab <span class="op">=</span> <span class="cn">NA</span>,
  ealphaw <span class="op">=</span> <span class="cn">NA</span>,
  truth <span class="op">=</span> <span class="cn">NA</span>,
  simulate <span class="op">=</span> <span class="cn">TRUE</span>,
  covariate <span class="op">=</span> <span class="cn">NULL</span>,
  lambda1 <span class="op">=</span> <span class="fl">4</span>,
  lambda2 <span class="op">=</span> <span class="fl">2</span>,
  covariate.prior.list <span class="op">=</span> <span class="cn">NULL</span>,
  tune.list <span class="op">=</span> <span class="cn">NULL</span>,
  start.list <span class="op">=</span> <span class="cn">NULL</span>,
  sample <span class="op">=</span> <span class="fl">1000</span>,
  thin <span class="op">=</span> <span class="fl">1</span>,
  burnin <span class="op">=</span> <span class="fl">1000</span>,
  verbose <span class="op">=</span> <span class="fl">0</span>,
  ret.beta <span class="op">=</span> <span class="st">"r"</span>,
  ret.mcmc <span class="op">=</span> <span class="cn">TRUE</span>,
  usrfun <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>A formula of the form \(t ~x\) in the \(2x2\) case and
\(cbind(col1,col2,...) ~ cbind(row1,row2,...)\) in the RxC case.</p></dd>
<dt>total</dt>
<dd><p>`total' is the name of the variable in the dataset that
contains the number of individuals in each unit</p></dd>
<dt>Zb</dt>
<dd><p>\(p\) x \(k^b\) matrix of covariates or the name of covariates
in the dataset</p></dd>
<dt>Zw</dt>
<dd><p>\(p\) x \(k^w\) matrix of covariates or the name of covariates
in the dataset</p></dd>
<dt>id</dt>
<dd><p>`id' is the name of the variable in the dataset that identifies
the precinct. Used for `movie' and `movieD' plot functions.</p></dd>
<dt>data</dt>
<dd><p>data frame that contains the variables that correspond to
formula.  If using covariates and data is specified, data should also
contain <code>Zb</code> and <code>Zw</code>.</p></dd>
<dt>erho</dt>
<dd><p>The standard deviation of the normal prior on \(\phi_5\) for
the correlation. Numeric vector, used one at a time, in order. Default `c(.5, 3, 5)`.</p></dd>
<dt>esigma</dt>
<dd><p>The standard deviation of an underlying normal distribution,
from which a half normal is constructed as a prior for both
\(\breve{\sigma}_b\) and \(\breve{\sigma}_w\). Default \(= 0.5\)</p></dd>
<dt>ebeta</dt>
<dd><p>Standard deviation of the "flat normal" prior on
\(\breve{B}^b\) and \(\breve{B}^w\).  The flat normal prior is uniform
within the unit square and dropping outside the square according to the
normal distribution.  Set to zero for no prior. Setting to positive values
probabilistically keeps the estimated mode within the unit square.
Default\(=0.5\)</p></dd>
<dt>ealphab</dt>
<dd><p>cols(Zb) x 2 matrix of means (in the first column) and
standard deviations (in the second) of an independent normal prior
distribution on elements of \(\alpha^b\).  If you specify Zb, you should
probably specify a prior, at least with mean zero and some variance (default
is no prior).  (See Equation 9.2, page 170, to interpret \(\alpha^b\)).</p></dd>
<dt>ealphaw</dt>
<dd><p>cols(Zw) x 2 matrix of means (in the first column) and
standard deviations (in the second) of an independent normal prior
distribution on elements of \(\alpha^w\).  If you specify Zw, you should
probably specify a prior, at least with mean zero and some variance (default
is no prior).  (See Equation 9.2, page 170, to interpret \(\alpha^w\)).</p></dd>
<dt>truth</dt>
<dd><p>A length(t) x 2 matrix of the true values of the quantities of
interest.</p></dd>
<dt>simulate</dt>
<dd><p>default = TRUE:see documentation in <code>eiPack</code> for
options for RxC ei.</p></dd>
<dt>covariate</dt>
<dd><p>see documentation in <code>eiPack</code> for options for RxC ei.</p></dd>
<dt>lambda1</dt>
<dd><p>default = 4:see documentation in <code>eiPack</code> for options
for RxC ei.</p></dd>
<dt>lambda2</dt>
<dd><p>default = 2:see documentation in <code>eiPack</code> for options
for RxC ei.</p></dd>
<dt>covariate.prior.list</dt>
<dd><p>see documentation in <code>eiPack</code> for options
for RxC ei.</p></dd>
<dt>tune.list</dt>
<dd><p>see documentation in <code>eiPack</code> for options for RxC ei.</p></dd>
<dt>start.list</dt>
<dd><p>see documentation in <code>eiPack</code> for options for RxC ei.</p></dd>
<dt>sample</dt>
<dd><p>default = 1000</p></dd>
<dt>thin</dt>
<dd><p>default = 1</p></dd>
<dt>burnin</dt>
<dd><p>default = 1000</p></dd>
<dt>verbose</dt>
<dd><p>default = 0:see documentation in <code>eiPack</code> for options
for RxC ei.</p></dd>
<dt>ret.beta</dt>
<dd><p>default = "r": see documentation in <code>eiPack</code> for
options for RxC ei.</p></dd>
<dt>ret.mcmc</dt>
<dd><p>default = TRUE: see documentation in <code>eiPack</code> for
options for RxC ei.</p></dd>
<dt>usrfun</dt>
<dd><p>see documentation in <code>eiPack</code> for options for RxC ei.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>TODO</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>EI</code> algorithm is run using the <code>ei</code> command.  A summary of
the results can be seen graphically using <code>plot(ei.object)</code> or
numerically using <code>summary(ei.object)</code>.  Quantities of interest can be
calculated using <code>eiread(ei.object)</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gary King (1997). A Solution to the Ecological Inference
Problem.  Princeton: Princeton University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Gary King &lt;&lt;email: king@harvard.edu&gt;&gt; and Molly Roberts &lt;&lt;email:
molly.e.roberts@gmail.com&gt;&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sample_ei</span><span class="op">)</span></span>
<span class="r-in"><span class="va">form</span> <span class="op">&lt;-</span> <span class="va">t</span> <span class="op">~</span> <span class="va">x</span></span>
<span class="r-in"><span class="va">dbuf</span> <span class="op">&lt;-</span> <span class="fu">ei</span><span class="op">(</span><span class="va">form</span>, total <span class="op">=</span> <span class="st">"n"</span>, data <span class="op">=</span> <span class="va">sample_ei</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Running 2x2 ei</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Maximizing likelihood</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Running 2x2 ei</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Running 2x2 ei <span style="color: #B2B2B2;">[332ms]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ⠙ Beginning importance sampling.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Beginning importance sampling. <span style="color: #B2B2B2;">[1.5s]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dbuf</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Erho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Esigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Ebeta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Resamp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Maximum likelihood results in scale of estimation (and se's)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Bb0       Bw0       sigB       sigW       rho Zb0 Zw0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -1.1534919 0.8217156 -2.2861904 -1.8819733 0.4123728   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.1009835 0.1017592  0.2487998  0.1575466 0.3652448   0   0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Untruncated psi's`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BB        BW        SB        SW      RHO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2000425 0.7258332 0.1032119 0.1546071 0.382822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Truncated psi's (ultimate scale)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         BB        BW         SB        SW       RHO</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2042132 0.7137129 0.09597692 0.1416928 0.3246235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Aggregate Bounds`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            betab     betaw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lower 0.09549504 0.3979843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> upper 0.60893461 0.8031228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`Estimates of Aggregate Quantities of Interest`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         mean          sd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bb 0.2037381 0.010621746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bw 0.7177117 0.008381275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $precision</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "summary"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Gary King, Molly Roberts.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

