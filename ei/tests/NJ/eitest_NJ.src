
    library ei;
    load NJ;
    clear t,x,n,Zb,Zw;
    t = vread(NJ, "t");
    x = vread(NJ, "x");
    n = vread(NJ, "n");
    clear truth;
    Zb = 1;
    Zw = 1;

    if vin(NJ, "Zb");
        Zb = eiread(NJ, "Zb");
    endif;
    if vin(NJ, "Zw");
        Zw = eiread(NJ, "Zw");
    endif;
    if vin(NJ, "truth");
        truth = eiread(NJ, "truth");
        _Eres = vput(_Eres, truth, "truth");
    endif;
    if scalone(Zb) and scalone(Zw);
        dataset = t~x~n;
    else;
        dataset = t~x~n~Zb~Zw;
    endif;

    output file=NJ/NJ.tab RESET;
    screen off;
    print dataset;
    output OFF;
    screen on;
    _EdoML=1;
    _EdoSim=0;

    rndseed(1);
    dbuf = ei(t,x,n,Zb,Zw);
    
    vc = eiread(dbuf, "VCphi");
    print_vc = reshape(vc,rows(vc)*cols(vc),1);
    screen off;
    output file=vc.asc RESET;
    print print_vc;
    output OFF;
    
    phi = eiread(dbuf, "phi");
    print_phi = reshape(phi,rows(phi)*cols(phi),1);
    screen off;
    output file=phi.asc RESET;
    print print_phi;
    output OFF;
    screen ON;

    _EdoML=0;

    loadvars vc.asc vc;
    _EdoML_VCphi = reshape(vc,5,5);
    print _EdoML_VCphi;
    loadvars phi.asc phi;
    _EdoML_phi = phi;
    print _EdoML_phi;
    
    _EdoSim=1;
    _Esims=100;
    rndseed(1);
    dbuf = ei(t,x,n,Zb,Zw);
    
        rndseed 1;
        res = eiread(dbuf, "aggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "beta");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testbeta.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "betaBs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testbetaBs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "betaWs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testbetaWs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI50b");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCI50b.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI50w");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCI50w.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI80bw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCI80bw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI95bw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCI95bw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CsbetaB");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCsbetaB.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CsbetaW");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testCsbetaW.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "EaggBias");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testEaggBias.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCI");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testExpVarCI.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCI0");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testExpVarCI0.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCIs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testExpVarCIs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEbw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testGEbw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEbwa");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testGEbwa.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEwb");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testGEwb.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEwba");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testGEwba.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "Maggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testMaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "mpPsiu");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testmpPsiu.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "Paggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testPaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "psi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testpsi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "R");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testR.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "sbetaB");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testsbetaB.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "sbetaW");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testsbetaW.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "tsims");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testtsims.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "tsims0");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testtsims0.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "VCaggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testVCaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ABounds");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testABounds.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "bounds");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testbounds.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "phi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testphi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "psiu");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testpsiu.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "VCphi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=NJ/testVCphi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;