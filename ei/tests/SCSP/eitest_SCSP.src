
    library ei;
    load SCSP;
    clear t,x,n,Zb,Zw;
    t = vread(SCSP, "t");
    x = vread(SCSP, "x");
    n = vread(SCSP, "n");
    clear truth;
    Zb = 1;
    Zw = 1;

    if vin(SCSP, "Zb");
        Zb = eiread(SCSP, "Zb");
    endif;
    if vin(SCSP, "Zw");
        Zw = eiread(SCSP, "Zw");
    endif;
    if vin(SCSP, "truth");
        truth = eiread(SCSP, "truth");
        _Eres = vput(_Eres, truth, "truth");
    endif;
    if scalone(Zb) and scalone(Zw);
        dataset = t~x~n;
    else;
        dataset = t~x~n~Zb~Zw;
    endif;

    output file=SCSP/SCSP.tab RESET;
    screen off;
    print dataset;
    output OFF;
    screen on;
    _EdoSim=1;
    _Esims=100;
    rndseed(1);
    dbuf = ei(t,x,n,Zb,Zw);
    
        rndseed 1;
        res = eiread(dbuf, "aggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "beta");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testbeta.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "betaBs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testbetaBs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "betaWs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testbetaWs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI50b");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCI50b.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI50w");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCI50w.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI80bw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCI80bw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CI95bw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCI95bw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CsbetaB");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCsbetaB.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "CsbetaW");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testCsbetaW.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "EaggBias");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testEaggBias.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCI");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testExpVarCI.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCI0");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testExpVarCI0.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ExpVarCIs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testExpVarCIs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEbw");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testGEbw.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEbwa");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testGEbwa.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEwb");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testGEwb.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "GEwba");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testGEwba.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "Maggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testMaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "mpPsiu");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testmpPsiu.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "Paggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testPaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "psi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testpsi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "R");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testR.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "sbetaB");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testsbetaB.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "sbetaW");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testsbetaW.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "tsims");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testtsims.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "tsims0");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testtsims0.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "VCaggs");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testVCaggs.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "ABounds");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testABounds.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "bounds");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testbounds.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "phi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testphi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "psiu");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testpsiu.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;
        rndseed 1;
        res = eiread(dbuf, "VCphi");
        res = reshape(res, rows(res)*cols(res), 1);
        output file=SCSP/testVCphi.tab RESET;
        screen off;
        print res;
        output OFF;
        screen on;